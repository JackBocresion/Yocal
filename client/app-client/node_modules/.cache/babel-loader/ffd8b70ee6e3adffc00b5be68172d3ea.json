{"ast":null,"code":"var _jsxFileName = \"/Users/jackbocresion/Desktop/YoCal current/client/app-client/src/App.tsx\";\n// import input from '@material-ui/core/input';\n// import './App.css';\nimport Navbar from './components/Nav';\nimport React, { useEffect, useState, createContext } from 'react';\nimport './styles/calendar.scss';\nimport './styles/App.css';\nimport Login from './components/Login';\nimport Home from './components/Home'; //import Home from './components/newhome';\n\nimport { Route, Switch, useLocation, useHistory } from 'react-router-dom';\nimport Createevent from './components/CreateEvent';\nimport './styles/Event.scss';\nimport axios from 'axios';\nimport FriendMenu from './components/FriendMenu';\nimport Edit from './components/Edit';\nimport './styles/toruskit.css';\nimport Spinner from './microComponents/spinner';\nimport Archive from './components/Archive';\nimport { valify } from './maps';\nimport io from 'socket.io-client';\nimport { useCycle } from 'framer-motion';\nMap.prototype.valify = valify; // import Conflicts from \"./components/Conflicts\"\n//use via props vs via a freq called func becasue it will give better performance!\n\nexport const userData = createContext();\nexport let socket = io();\n\nconst App = () => {\n  //create a function here that will create the props data. if it cannot find the data for the prop, redirect and/or return null.\n  const [state, setState] = useState({\n    username: null,\n    data: null,\n    events: null,\n    friendEvents: null,\n\n    /*--------------------*/\n    friendReqs: null,\n    friends: null,\n\n    /*--------------------*/\n    month: null,\n    year: null,\n\n    /* ------------------ */\n    chats: null,\n    messages: null\n  });\n  const history = useHistory();\n  const location = useLocation(); //dont allow users to enter without logging in\n\n  useEffect(() => {\n    if (location.pathname !== '/' && localStorage.getItem('token') === null) {\n      history.push('/');\n    }\n  });\n  useEffect(() => {\n    console.log('state updated!');\n    console.table(state);\n  }, [state]);\n  useEffect(() => {\n    getData();\n  }, []);\n  const [connectionStarted, startConnection] = useCycle(false, true);\n  useEffect(() => {\n    if (connectionStarted) {\n      console.log('CONNECTION STARTING');\n      socket = io.connect('http://localhost:4000', {\n        query: `uuid=${state.uuid}`\n      });\n      socket.on('pong', m => {\n        console.log('ponged');\n      });\n      socket.on('requested', m => {\n        console.log('requested by user', m);\n      });\n      socket.emit('555', 'f');\n      socket.on(\"f\", () => {\n        console.log(\"hb!\");\n      });\n      socket.on(\"invite\", event => {\n        console.log(\"fasdfasdfasdfsadfasdf\");\n        console.log(event, \" <- INVITED TO EVENT!!\");\n      });\n      console.log(state);\n    }\n  }, [connectionStarted]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(userData.Provider, {\n    value: [state, setState],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 13\n    }\n  }, state.username == null && window.location.pathname != '/' ? /*#__PURE__*/React.createElement(Spinner, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 19\n    }\n  }) : /*#__PURE__*/React.createElement(React.Fragment, null, state.username && /*#__PURE__*/React.createElement(Navbar, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 41\n    }\n  }), /*#__PURE__*/React.createElement(Switch, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 22\n    }\n  }, /*#__PURE__*/React.createElement(Route, {\n    path: \"/\",\n    exact: true,\n    component: Login,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 25\n    }\n  }), /*#__PURE__*/React.createElement(Route, {\n    path: \"/home\",\n    exact: true,\n    component: Home,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 25\n    }\n  }), /*#__PURE__*/React.createElement(Route, {\n    exact: true,\n    path: \"/home/:day/:month/:year\",\n    component: Createevent,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 25\n    }\n  }), /*#__PURE__*/React.createElement(Route, {\n    exact: true,\n    path: \"/friends\",\n    component: FriendMenu,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 25\n    }\n  }), /*#__PURE__*/React.createElement(Route, {\n    exact: true,\n    path: \"/edit/:id\",\n    component: Edit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 25\n    }\n  }), /*#__PURE__*/React.createElement(Route, {\n    exact: true,\n    path: \"/archive\",\n    component: Archive,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 25\n    }\n  }), /*#__PURE__*/React.createElement(Route, {\n    render: () => /*#__PURE__*/React.createElement(\"h1\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 46\n      }\n    }, \"404 error\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 25\n    }\n  })))));\n\n  async function getData() {\n    try {\n      //auth with token\n      const {\n        data\n      } = await axios.get('http://localhost:8000/getuser', {\n        headers: {\n          Authorization: 'Bearer ' + localStorage.getItem('token')\n        }\n      }); //set userdata\n\n      setState({ ...data,\n        events: new Map(data.events),\n        incoming: new Map(data.incoming),\n        outgoing: new Map(data.outgoing)\n      });\n\n      if (location.pathname === '/') {\n        history.push('/home');\n      }\n\n      startConnection();\n    } catch (e) {\n      history.push('/');\n      console.error(e);\n      console.log('ERROR');\n    } finally {\n      console.log('getdata called in appjs');\n    }\n  }\n};\n\nexport default App;","map":{"version":3,"sources":["/Users/jackbocresion/Desktop/YoCal current/client/app-client/src/App.tsx"],"names":["Navbar","React","useEffect","useState","createContext","Login","Home","Route","Switch","useLocation","useHistory","Createevent","axios","FriendMenu","Edit","Spinner","Archive","valify","io","useCycle","Map","prototype","userData","socket","App","state","setState","username","data","events","friendEvents","friendReqs","friends","month","year","chats","messages","history","location","pathname","localStorage","getItem","push","console","log","table","getData","connectionStarted","startConnection","connect","query","uuid","on","m","emit","event","window","get","headers","Authorization","incoming","outgoing","e","error"],"mappings":"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","sourcesContent":["// import input from '@material-ui/core/input';\n// import './App.css';\n\nimport Navbar from './components/Nav';\nimport React, { useEffect, useState, createContext, useContext } from 'react';\nimport './styles/calendar.scss';\nimport './styles/App.css';\nimport Login from './components/Login';\nimport Home from './components/Home';\n//import Home from './components/newhome';\nimport {\n   BrowserRouter as Router,\n   Route,\n   Switch,\n   Redirect,\n   useLocation,\n   useHistory,\n} from 'react-router-dom';\nimport Createevent from './components/CreateEvent';\nimport './styles/Event.scss';\nimport axios from 'axios';\nimport FriendMenu from './components/FriendMenu';\nimport BetaFooter from './components/BetaFooter';\nimport Edit from './components/Edit';\nimport './styles/toruskit.css';\nimport Spinner from './microComponents/spinner';\nimport Archive from './components/Archive';\nimport { valify } from './maps';\n\nimport Notification from './microComponents/notification';\nimport io from 'socket.io-client';\nimport { useCycle } from 'framer-motion';\nMap.prototype.valify = valify;\n// import Conflicts from \"./components/Conflicts\"\n//use via props vs via a freq called func becasue it will give better performance!\n\ninterface User {\n   username: string,\n   uuid: string,\n   events: Array<Event>,\n   incoming: Array<FriendRequest>,\n   outgoing:Array<FriendRequest>\n   \n}\nexport interface Event {\n   eventid: string;\n   title: string;\n   date: string;\n   duration: number;\n   creator: number;\n}\ninterface FriendRequest {\n   requestid: string,\n   requester: string,\n   requested: string\n}\nexport const userData = createContext<User>();\nexport let socket = io()\nconst App = () => {\n   //create a function here that will create the props data. if it cannot find the data for the prop, redirect and/or return null.\n   const [state, setState] = useState({\n      username: null,\n      data: null,\n      events: null,\n      friendEvents: null,\n      /*--------------------*/\n      friendReqs: null,\n      friends: null,\n      /*--------------------*/\n      month: null,\n      year: null,\n      /* ------------------ */\n      chats: null,\n      messages: null,\n   });\n\n   const history = useHistory();\n   const location = useLocation();\n   //dont allow users to enter without logging in\n   useEffect(() => {\n      if (location.pathname !== '/' && localStorage.getItem('token') === null) {\n         history.push('/');\n      }\n   });\n\n   useEffect(() => {\n      console.log('state updated!');\n      console.table(state);\n   }, [state]);\n\n   useEffect(() => {\n      getData();\n   }, []);\n\n   const [connectionStarted, startConnection] = useCycle(false, true);\n\n   useEffect(() => {\n      if (connectionStarted) {\n         console.log('CONNECTION STARTING');\n         socket = io.connect('http://localhost:4000', { query: `uuid=${state.uuid}` });\n         socket.on('pong', (m) => {\n            console.log('ponged');\n         });\n         socket.on('requested', (m) => {\n            console.log('requested by user', m);\n         });\n         socket.emit('555', 'f');\n         socket.on(\"f\", () => { console.log(\"hb!\") })\n         socket.on(\"invite\", (event) => {\n            console.log(\"fasdfasdfasdfsadfasdf\")\n            console.log(event, \" <- INVITED TO EVENT!!\")\n         })\n         console.log(state)\n      }\n   }, [connectionStarted]);\n   return (\n      <div>\n            <userData.Provider value={[state, setState]}>\n               {state.username == null && window.location.pathname != '/' ? (\n                  <Spinner />\n               ) : (\n                  <>\n                     {state.username && <Navbar />}\n\n                     <Switch>\n                        <Route path=\"/\" exact component={Login} />\n                        <Route path=\"/home\" exact component={Home} />\n                        <Route\n                           exact\n                           path=\"/home/:day/:month/:year\"\n                           component={Createevent}\n                        />\n                        <Route exact path=\"/friends\" component={FriendMenu} />\n                        <Route exact path=\"/edit/:id\" component={Edit} />\n                        <Route exact path=\"/archive\" component={Archive} />\n                        <Route render={() => <h1>404 error</h1>} />\n                     </Switch>\n                     {/* <BetaFooter /> */}\n                  </>\n               )}\n            </userData.Provider>\n      </div>\n   );\n   async function getData() {\n      try {\n         //auth with token\n         const { data } = await axios.get('http://localhost:8000/getuser', {\n            headers: {\n               Authorization: 'Bearer ' + localStorage.getItem('token'),\n            },\n         });\n         //set userdata\n         setState({\n            ...data,\n            events: new Map(data.events),\n            incoming: new Map(data.incoming),\n            outgoing: new Map(data.outgoing)\n         });\n\n         if (location.pathname === '/') {\n            history.push('/home');\n         }\n         startConnection();\n      } catch (e) {\n         history.push('/');\n         console.error(e);\n         console.log('ERROR');\n      } finally {\n         console.log('getdata called in appjs');\n      }\n   }\n};\nexport default App;\n"]},"metadata":{},"sourceType":"module"}